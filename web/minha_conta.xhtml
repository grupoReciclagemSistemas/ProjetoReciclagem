<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Java Server Faces</title>    
    </h:head>
    <h:body>
        <ui:include src="/WEB-INF/menu.xhtml" />
        <b:jumbotron style="background-color: white;"> 
            <h:form prependId="false">
                <b:row>
                    <b:column span="3">
                        <b:container style="padding-right: 150px;">

                            <b:panel collapsible="false" title-style="background-color: white; color: green;" title="GERENCIAR SUA CONTA">
                                <b:listLinks>
                                    <center> <h:outputLabel value="DADOS GERAIS"/> </center>
                                    <b:commandLink value="Ver Dados"  look="info" update="@form" />
                                    <center> <h:outputLabel value="AÇÕES DISPONÍVEIS" style="margin-top: 5px"/> </center>
                                    <b:commandLink value="Lista de Materiais à Venda"  look="success" update="@form" rendered="#{controladorLogado.recicladorLogado != null}" />
                                    <b:commandLink value="Vender Materiais"  look="success" update="@form" rendered="#{controladorLogado.geradorLogado != null}" />
                                    <b:commandLink value="Convites para Transportar"  look="success" update="@form" rendered="#{controladorLogado.transportadorLogado != null}" />
                                    <b:commandLink value="Deslogar" look="warning" action="#{controladorLogado.deslogar()}" />
                                    <b:commandLink value="Remover Conta" look="danger" onclick="return confirm('Deseja realmente abrir uma Transação para deletar sua conta?')" />
                                </b:listLinks>
                            </b:panel>

                        </b:container>
                    </b:column>

                    <b:column span="9" >
                        <h:panelGrid columns="4" rendered="#{controladorLogado.geradorLogado != null}" >
                            <b:container>
                                <b:panel collapsible="false" title="Dados Gerais: #{controladorLogado.geradorLogado.razaoSocial}">                       
                                    <b:inputText readonly="true" label="Seu E-mail:" value="#{controladorLogado.geradorLogado.email}" col-sm="4"/>
                                    <b:inputText readonly="true" label="Seu CNPJ:" value="#{controladorLogado.geradorLogado.cnpj}" col-sm="4"/>
                                    <b:inputText readonly="true" label="Seu Telefone:" value="#{controladorLogado.geradorLogado.telefone}" col-sm="4"/>     
                                </b:panel>
                                <b:panel collapsible="false" title="SEU ENDEREÇO:">
                                    <b:inputText readonly="true" label="Logradouro:" value="#{controladorLogado.geradorLogado.endereco.logradouro}" col-sm="3"/>
                                    <b:inputText readonly="true" label="CEP:" value="#{controladorLogado.geradorLogado.endereco.cep}" col-sm="2"/>
                                    <b:inputText readonly="true" label="Cidade:" value="#{controladorLogado.geradorLogado.endereco.cidade}" col-sm="3"/>
                                    <b:inputText readonly="true" label="UF:" value="#{controladorLogado.geradorLogado.endereco.uf}" col-sm="1"/>
                                    <b:inputText readonly="true" label="Bairro:" value="#{controladorLogado.geradorLogado.endereco.bairro}" col-sm="3"/>
                                </b:panel>

                                <b:panel collapsible="false" title="SEU ESTOQUE:">
                                    <b:dataTable var="estoque" value="#{controladorLogado.geradorLogado.estoques}"
                                                 customLangUrl="//cdn.datatables.net/plug-ins/1.10.12/i18n/Portuguese-Brasil.json"
                                                 responsive="true">
                                        <b:dataTableColumn label="Nome do Material" value="#{estoque.estoque.material.nome}" style="width: 80px;"/>
                                        <b:dataTableColumn label="Quantidade de Material" value="#{estoque.estoque.quantidadeMaterial} toneladas" 
                                                           orderBy="#{estoque.estoque.quantidadeMaterial}" style="width: 25px;"/>
                                        <b:dataTableColumn label="ADICIONAR QUANTIDADE" style="width: 30px; text-align: center">
                                            <b:button look="info" value="EDITAR" col-lg="12" onclick="$('.teste').modal()" onmousemove="#{controladorGerador.setarEstoqueGerador(estoque)}" />
                                               
                                        </b:dataTableColumn>
                                        <b:dataTableColumn label="VENDER" style="width: 30px; text-align: center">
                                            <b:commandButton look="success" value="VENDER" col-lg="12" actionListener="#{controladorGerador.venderEstoqueGerador(estoque)}" 
                                                             update=":formVender"/>
                                              
                                        </b:dataTableColumn>
                                    </b:dataTable>
                                    <f:facet name="footer">
                                        <b:button look="success" value="Adicionar novo material..."   onclick="$('.modalPseudoClass2').modal()" />                                                                        
                                    </f:facet>
                                </b:panel>
                                
                                <b:modal id="modalNovoEstoque" styleClass="modalPseudoClass2" title="Adicionar Novo Estoque - #{controladorLogado.geradorLogado.razaoSocial}" closable="false"
                                         close-on-escape="false" backdrop="false">
                                    <b:panel>
                                        <h:form>
                                            <h:outputLabel value="Lista de Materiais Disponíveis" />
                                            <b:selectOneMenu value="#{controladorGerador.materialEscolhido}">
                                                <f:selectItems var="material" value="#{controladorLogado.geradorLogado.listaDeMaterialQuePodeAdicionar()}" itemLabel="#{material.nome}" itemValue="#{material}"/>
                                            </b:selectOneMenu>
                                            <b:inputText label="Quantidade do Material (TONELADAS)" value="#{controladorGerador.quantidadeDoMaterialEscolhido}" mask="numeric"/>
                                            <b:commandButton value="Adicionar no Estoque" look="success" style="margin-right: 5px;" action="#{controladorGerador.adicionarNoEstoque(controladorLogado.geradorLogado)}"/>
                                            <b:button value="Fechar Janela" look="warning" dismiss="modal" />
                                        </h:form>
                                    </b:panel>
                                </b:modal>
                                
                                <b:modal id="editarQuantidade" styleClass="teste" title="Editar Quantidade do Estoque - #{controladorGerador.estoque}" closable="false"
                                         close-on-escape="false" backdrop="false" >
                                    <b:panel>
                                        <h:form>
                                            <h:outputLabel value="Digite a quantidade que deseja incluir nesse Estoque de Material" />
                                            <b:inputText value="#{controladorGerador.quantidadeMais}" />
                                            <b:commandButton value="Adicionar" action="#{controladorGerador.mudarQuantidadeTotal()}" look="success" style="margin-right: 4px;"/>
                                            <b:commandButton value="Cancelar" action="#{controladorGerador.cancelar()}" look="warning"/>
                                        </h:form>
                                    </b:panel>
                                </b:modal>
                                                                                        
                            </b:container>
                        </h:panelGrid>                 
                        <h:panelGrid columns="4" rendered="#{controladorLogado.recicladorLogado != null}">
                            <b:container>
                                <b:panel collapsible="false" title="Dados Gerais: #{controladorLogado.recicladorLogado.razaoSocial}">                       
                                    <b:inputText readonly="true" label="Seu E-mail:" value="#{controladorLogado.recicladorLogado.email}" col-sm="4"/>
                                    <b:inputText readonly="true" label="Seu CNPJ:" value="#{controladorLogado.recicladorLogado.cnpj}" col-sm="4"/>
                                    <b:inputText readonly="true" label="Seu Telefone:" value="#{controladorLogado.recicladorLogado.telefone}" col-sm="4"/>     
                                </b:panel>
                                <b:panel collapsible="false" title="SEU ENDEREÇO:">
                                    <b:inputText readonly="true" label="Logradouro:" value="#{controladorLogado.recicladorLogado.endereco.logradouro}" col-sm="3"/>
                                    <b:inputText readonly="true" label="CEP:" value="#{controladorLogado.recicladorLogado.endereco.cep}" col-sm="2"/>
                                    <b:inputText readonly="true" label="Cidade:" value="#{controladorLogado.recicladorLogado.endereco.cidade}" col-sm="3"/>
                                    <b:inputText readonly="true" label="UF:" value="#{controladorLogado.recicladorLogado.endereco.uf}" col-sm="1"/>
                                    <b:inputText readonly="true" label="Bairro:" value="#{controladorLogado.recicladorLogado.endereco.bairro}" col-sm="3"/>
                                </b:panel>
            
                            </b:container>
                        </h:panelGrid>
                        
                        <h:panelGrid columns="4" rendered="#{controladorLogado.transportadorLogado != null}">
                            <b:container>
                                <b:panel collapsible="false" title="Dados Gerais: #{controladorLogado.transportadorLogado.razaoSocial}">                       
                                    <b:inputText readonly="true" label="Seu E-mail:" value="#{controladorLogado.transportadorLogado.email}" col-sm="4"/>
                                    <b:inputText readonly="true" label="Seu CNPJ:" value="#{controladorLogado.transportadorLogado.cnpj}" col-sm="4"/>
                                    <b:inputText readonly="true" label="Seu Telefone:" value="#{controladorLogado.transportadorLogado.telefone}" col-sm="4"/>     
                                </b:panel>
                                <b:panel collapsible="false" title="SEU ENDEREÇO:">
                                    <b:inputText readonly="true" label="Logradouro:" value="#{controladorLogado.transportadorLogado.endereco.logradouro}" col-sm="3"/>
                                    <b:inputText readonly="true" label="CEP:" value="#{controladorLogado.transportadorLogado.endereco.cep}" col-sm="2"/>
                                    <b:inputText readonly="true" label="Cidade:" value="#{controladorLogado.transportadorLogado.endereco.cidade}" col-sm="3"/>
                                    <b:inputText readonly="true" label="UF:" value="#{controladorLogado.transportadorLogado.endereco.uf}" col-sm="1"/>
                                    <b:inputText readonly="true" label="Bairro:" value="#{controladorLogado.transportadorLogado.endereco.bairro}" col-sm="3"/>
                                </b:panel>
            
                            </b:container>
                        </h:panelGrid>
                    </b:column>
                </b:row>
            </h:form>
            
            <h:form id="formVender">
                <b:panel id="panelVender" title="#{controladorGerador.estoque.estoque.material.nome}" rendered="#{controladorGerador.vender == true}">
                                        
                                            <h:outputLabel value="Digite o valor que deseja vender (R$ / KG)" />
                                            <b:inputText value="#{controladorGerador.valorPorKG}" update="@this" process="@this" />
                                            <h:outputLabel value="Digite a quantidade que deseja vender (TOTAL : #{controladorGerador.estoque.estoque.quantidadeMaterial})" />
                                            <b:inputText value="#{controladorGerador.quantidadeTotal}" update="@this" process="@this" />
                                            <b:commandButton value="Salvar" action="#{controladorGerador.listarVenda(controladorLogado.geradorLogado)}"
                                              update="formVender" immediate="true" look="success" style="margin-right: 4px;"/>
                                            <b:commandButton value="Cancelar" action="#{controladorGerador.cancelarVenda()}" look="warning"/>
                                       
                        </b:panel>
              </h:form>
            
            <h:form id="negociacoes" style="width: 30%; height: 30%; text-align: center;">
                <b:panel title="Suas Negociações" id="panelNegociacoes" rendered="#{controladorLogado.recicladorLogado != null}" collapsible="false">
                    <b:dataTable var="negociacao" value="#{controladorLogado.recicladorLogado.negociacoes}">
                       <b:dataTableColumn label="Nome do Material" value="#{negociacao.pedido.itens.get(0).material.nome}"/>
                       <b:dataTableColumn label="Gerador" value="#{negociacao.pedido.gerador.razaoSocial}"/>
                       <b:dataTableColumn label="Total do Pedido" value="R$ #{negociacao.pedido.valorTotal}"/>
                       <b:dataTableColumn label="Peso em KG" value="R$ #{negociacao.pedido.valorTotal}"/>
                       <b:dataTableColumn label="Mandar MSG">
                           <b:commandButton value="Ir para o Chat" look="info" action="chatNegociacao?faces-redirect=true"
                                            actionListener="#{controladorNegociacao.listenerIrNegociar(negociacao)}" />
                       </b:dataTableColumn>
                    </b:dataTable>
                </b:panel>
            </h:form>
            
            <h:form id="negociacoes2" style="width: 30%; height: 30%; text-align: center;">
                <b:panel title="Suas Negociações" id="panelNegociacoes" rendered="#{controladorLogado.geradorLogado != null}" collapsible="false">
                    <b:dataTable var="negociacao" value="#{controladorLogado.geradorLogado.negociacoes}">
                       <b:dataTableColumn label="Nome do Material" value="#{negociacao.pedido.itens.get(0).material.nome}"/>
                       <b:dataTableColumn label="Reciclador" value="#{negociacao.reciclador.razaoSocial}"/>
                       <b:dataTableColumn label="Total do Pedido" value="R$ #{negociacao.pedido.valorTotal}"/>
                       <b:dataTableColumn label="Peso em KG" value="R$ #{negociacao.pedido.valorTotal}"/>
                       <b:dataTableColumn label="Mandar MSG">
                           <b:commandButton value="Ir para o Chat" look="info" action="chatNegociacao?faces-redirect=true"
                                            actionListener="#{controladorNegociacao.listenerIrNegociar(negociacao)}" />
                       </b:dataTableColumn>
                    </b:dataTable>
                </b:panel>
            </h:form>
        </b:jumbotron>
        <h:form prependId="false">
       <p:menu>
           <p:submenu label="DADOS GERAIS">
            <p:menuitem value="Ver Dados" action="#{menuView.save}"  />
        </p:submenu>
        <p:submenu label="Non-Ajax">
            <p:menuitem value="Delete" action="#{menuView.delete}"  ajax="false" icon="pi pi-times"/>
        </p:submenu>
        <p:submenu label="Navigations">
            <p:menuitem value="External" url="http://www.primefaces.org" icon="pi pi-home"/>
            <p:menuitem value="Internal" icon="pi pi-star"/>
        </p:submenu>
    </p:menu>
        </h:form>
    </h:body>
</html>
