
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:b="http://bootsfaces.net/ui"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Java Server Faces</title>    
    </h:head>
    <h:body>      

        <ui:include src="/WEB-INF/menu.xhtml" />

        <h:form prependId="false">
            <p:messages id="messages" showDetail="true"/>
            
        </h:form>

        <h:form id="formReciclador" rendered="#{controladorNegociacao.negociacao != null and controladorLogado.recicladorLogado != null}" 
                style="margin-top: 5%; margin-left: 15%; margin-right: 15%;" prependId="false">
            <p:tabView id="tabViewReciclador" prependId="false"> 
                <p:tab title="CHAT DE NEGOCIAÇÃO COM #{controladorNegociacao.negociacao.gerador.razaoSocial}">
                    <p:dataTable id="dataListReciclador" value="#{controladorNegociacao.negociacao.chat.chatAplicacao}" var="msg" scrollable="true" scrollHeight="200" 
                                 selection="#{controladorNegociacao.chatAplicacaoSelecionado}" selectionMode="single" rowKey="#{msg.idChatAplicacao}" lazy="true" >
                        <p:column headerText="PESSOA" width="20%">               
                            <p:outputLabel style="color: green; font-weight: bold;" value="#{msg.pessoa.razaoSocial}" />              
                        </p:column>
                        <p:column headerText="MENSAGEM" width="70%">
                            <p:outputLabel value="#{msg.mensagem}" />
                        </p:column>
                        <p:column headerText="DATA/HORA" width="20%">
                            <p:outputLabel value="#{msg.dataHora}" />
                        </p:column>
                    </p:dataTable>
                    <p:inputTextarea id="novaMsg1" value="#{controladorNegociacao.novaMensagem}" style="margin-top: 2%; width: 100%;" rows="2">
                        <p:ajax event="change" process="@this" />
                    </p:inputTextarea>
                    
                    <p:commandButton id="btn-enviar1" icon="fa fa-send" value="Enviar Mensagem" action="#{controladorNegociacao.adicionarNovaMensagemReciclador(controladorLogado.recicladorLogado)}"
                                         style="margin-top: 2%; color: green; border-color: green;" update="tabViewReciclador" immediate="true"  />
                    <p:commandButton id="btn-concluir1" icon="fa fa-check" value="Concluir Negociação" 
                             style="margin-top: 2%; margin-left: 1%; color: blue; border-color: blue;" update="btn-enviar1, formReciclador, novaMsg1, messages" immediate="true"/>
            <p:commandButton id="btn-cancelar1" icon="fa fa-remove" value="Encerrar Negociação" 
                             style="margin-top: 2%; margin-left: 1%; color: red; border-color: red;" update="btn-enviar1, formReciclador, novaMsg1, messages" immediate="true"/>
                </p:tab>            
            </p:tabView>
        </h:form>

        <h:form  id="formGerador" rendered="#{controladorNegociacao.negociacao != null and controladorLogado.geradorLogado != null}" 
                 style="margin-top: 5%; margin-left: 15%; margin-right: 15%;" prependId="false">
            <p:tabView id="tabViewGerador" prependId="false">
                <p:tab title="CHAT DE NEGOCIAÇÃO COM #{controladorNegociacao.negociacao.reciclador.razaoSocial}">
            <p:dataTable id="dataListGerador" value="#{controladorNegociacao.negociacao.chat.chatAplicacao}" var="msg" scrollable="true" scrollHeight="200">
                <p:column headerText="PESSOA" width="20%">               
                            <p:outputLabel style="color: green; font-weight: bold;" value="#{msg.pessoa.razaoSocial}" />              
                        </p:column>
                        <p:column headerText="MENSAGEM" width="70%">
                            <p:outputLabel value="#{msg.mensagem}" />
                        </p:column>
                        <p:column headerText="DATA/HORA" width="20%">
                            <p:outputLabel value="#{msg.dataHora}" />
                        </p:column>
            </p:dataTable>
            <p:inputTextarea id="novaMsg2" value="#{controladorNegociacao.novaMensagem}" style="margin-top: 2%; width: 100%;" rows="2">
                        <p:ajax event="change" process="@this" />
             </p:inputTextarea>

            <p:commandButton id="btn-enviar2" icon="fa fa-send" value="Enviar Mensagem" action="#{controladorNegociacao.adicionarNovaMensagemGerador(controladorLogado.geradorLogado)}"
                             style="margin-top: 2%; color: green; border-color: green;" update="tabViewGerador" immediate="true"/>
            <p:commandButton id="btn-concluir2" icon="fa fa-check" value="Concluir Negociação"
                             style="margin-top: 2%; margin-left: 1%; color: blue; border-color: blue;" update="btn-enviar2, formGerador, novaMsg2, messages" immediate="true"/>
            <p:commandButton id="btn-cancelar2" icon="fa fa-remove" value="Encerrar Negociação" 
                             style="margin-top: 2%; margin-left: 1%; color: red; border-color: red;" update="btn-enviar2, formGerador, novaMsg2, messages" immediate="true"/>
                </p:tab>
            </p:tabView>
        </h:form>
    </h:body>
</html>
